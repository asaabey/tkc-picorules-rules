WITH CTE000 AS (SELECT EID FROM EADV GROUP BY EID),CTE001 AS (SELECT EID,COUNT(VAL) AS sbp_cnt  FROM EADV WHERE (ATT = 'SYSTOLIC') GROUP BY EID),
CTE002 AS (SELECT EID,COUNT(VAL) AS sbp140_cnt  FROM EADV WHERE (ATT = 'SYSTOLIC') AND VAL>140 AND DT>TO_DATE('01/01/2017','DD/MM/YYYY') GROUP BY EID),
CTE003 AS (SELECT EID, TO_DATE('01/01/2017','DD/MM/YYYY') AS dt0  FROM EADV WHERE 1=1 GROUP BY EID)
 SELECT CTE000.EID, CTE001.sbp_cnt 
,CTE002.sbp140_cnt 
,CTE003.dt0 
FROM CTE000 LEFT OUTER JOIN CTE001 ON CTE001.EID=CTE000.EID 
 LEFT OUTER JOIN CTE002 ON CTE002.EID=CTE000.EID 
 LEFT OUTER JOIN CTE003 ON CTE003.EID=CTE000.EID 
;